<div class="page-wrapper">
  <a id="show-sidebar" class="sidebar-toggle-btn" (click)="toggleSidebar()">
    <i
      class="fas"
      [class.fa-bars]="!sidebarCollapsed"
      [class.fa-angles-right]="sidebarCollapsed"
    ></i>
  </a>
  <nav
    id="sidebar"
    class="sidebar-wrapper"
    [class.active]="sidebarActive"
    [class.collapsed]="sidebarCollapsed"
  >
    <div class="sidebar-content">
      <div class="sidebar-brand">
        <div id="close-sidebar" (click)="toggleSidebar()">
          <i class="fi fi-rr-menu-burger"></i>
        </div>
      </div>
      <!-- <div class="sidebar-header">
        <div class="user-pic">
          <img src="src/assets/img/irs-Picsart-BackgroundRemover.PNG" alt="Logotipo empresa" />
        </div>
        <div class="user-info" *ngIf="!sidebarCollapsed">
          <span class="user-name">Sistema IRS</span>
        </div>
      </div> -->

      <div class="sidebar-menu">
        <ul>
          <li [class.li-activa]="isActiveRoute('/inicio')">
            <a
              routerLink="/inicio"
              (click)="closeSidebarOnMobile()"
              [title]="sidebarCollapsed ? 'Inicio' : ''"
            >
              <i class="fi fi-rr-home"></i>
              <span *ngIf="!sidebarCollapsed">Inicio</span>
            </a>
          </li>

          <li [class.has-submenu-open]="submenuOpen['fichas']">
            <a
              (click)="handleSubmenuClick($event,'fichas')"
              class="submenu-desplegable"
              [title]="sidebarCollapsed ? 'Fichas' : ''"
            >
              <i class="fi fi-rs-memo-circle-check"></i>
              <span *ngIf="!sidebarCollapsed">Fichas</span>
              <i
                *ngIf="!sidebarCollapsed"
                class="fas fa-angle-down arrow-icon"
                [class.rotate]="submenuOpen['fichas']"
              ></i>
            </a>
            <ul
              class="submenu"
              [class.show]="submenuOpen['fichas']"
              *ngIf="!sidebarCollapsed"
            >
              <li>
                <a
                  routerLink="/fichas/registrar"
                  class="option-submenu"
                  (click)="closeSidebarOnMobile()"
                  [class.active]="isActiveRoute('/fichas/registrar')"
                >
                  <i class="fi fi-rs-add-document"></i>
                  <span>Registrar ficha</span>
                </a>
              </li>
              <li>
                <a
                  routerLink="/fichas/borradores"
                  class="option-submenu"
                  (click)="closeSidebarOnMobile()"
                  [class.active]="isActiveRoute('/fichas/borradores')"
                >
                  <i class="fi fi-rs-document-circle-wrong"></i>
                  <span>Borradores</span>
                </a>
              </li>
            </ul>
          </li>
          <li [class.has-submenu-open]="submenuOpen['consultar-fichas']">
            <a
              (click)="handleSubmenuClick($event,'consultar-fichas')"
              class="submenu-desplegable"
              [title]="sidebarCollapsed ? 'Consultar Fichas' : ''"
            >
              <i class="fi fi-rr-search-alt"></i>
              <span *ngIf="!sidebarCollapsed">Consultar Fichas</span>
              <i
                *ngIf="!sidebarCollapsed"
                class="fas fa-angle-down arrow-icon"
                [class.rotate]="submenuOpen['consultar-fichas']"
              ></i>
            </a>
            <ul
              class="submenu"
              [class.show]="submenuOpen['consultar-fichas']"
              *ngIf="!sidebarCollapsed"
            >
              <li>
                <a
                  routerLink="/consultar-fichas/dia"
                  class="option-submenu"
                  (click)="closeSidebarOnMobile()"
                  [class.active]="isActiveRoute('/consultar-fichas/dia')"
                >
                  <i class="fi fi-rr-calendar-day"></i>
                  <span>Del día</span>
                </a>
              </li>
              <li>
                <a
                  routerLink="/consultar-fichas/todas"
                  class="option-submenu"
                  (click)="closeSidebarOnMobile()"
                  [class.active]="isActiveRoute('/consultar-fichas/todas')"
                >
                  <i class="fi fi-rr-calendar-days"></i>
                  <span>Todas</span>
                </a>
              </li>
            </ul>
          </li>

          <li [class.li-activa]="isActiveRoute('/mapa-fichas')">
            <a
              routerLink="/mapa-fichas"
              (click)="closeSidebarOnMobile()"
              [title]="sidebarCollapsed ? 'Mapa de fichas' : ''"
            >
              <i class="fi fi-rs-map-marker"></i>
              <span *ngIf="!sidebarCollapsed">Mapa de fichas</span>
            </a>
          </li>

          <li [class.li-activa]="isActiveRoute('/estadisticas')">
            <a
              routerLink="/estadisticas"
              (click)="closeSidebarOnMobile()"
              [title]="sidebarCollapsed ? 'Mis estadísticas' : ''"
            >
              <i class="fi fi-rs-chart-histogram"></i>
              <span *ngIf="!sidebarCollapsed">Mis estadísticas</span>
            </a>
          </li>

          <!-- Opción Despacho - Solo visible para rol 6 -->
          <li
            *ngIf="esRolDespacho"
            [class.li-activa]="isActiveRoute('/despacho')"
          >
            <a
              routerLink="/despacho"
              (click)="closeSidebarOnMobile()"
              [title]="sidebarCollapsed ? 'Despacho' : ''"
            >
              <i class="fi fi-rr-file-user"></i>
              <span *ngIf="!sidebarCollapsed">Despacho</span>
            </a>
          </li>

          <li [class.has-submenu-open]="submenuOpen['admin-usuarios']">
            <a
              (click)="handleSubmenuClick($event,'admin-usuarios')"
              class="submenu-desplegable"
              [title]="sidebarCollapsed ? 'Admin Usuarios' : ''"
            >
              <i class="fi fi-rr-users-alt"></i>
              <span *ngIf="!sidebarCollapsed">Admin Usuarios</span>
              <i
                *ngIf="!sidebarCollapsed"
                class="fas fa-angle-down arrow-icon"
                [class.rotate]="submenuOpen['admin-usuarios']"
              ></i>
            </a>
            <ul
              class="submenu"
              [class.show]="submenuOpen['admin-usuarios']"
              *ngIf="!sidebarCollapsed"
            >
              <li>
                <a
                  routerLink="/admin-usuarios/registrar"
                  class="option-submenu"
                  (click)="closeSidebarOnMobile()"
                  [class.active]="isActiveRoute('/admin-usuarios/registrar')"
                >
                  <i class="fi fi-rs-user-add"></i>
                  <span>Registrar usuario</span>
                </a>
              </li>
              <li>
                <a
                  routerLink="/admin-usuarios/editar"
                  class="option-submenu"
                  (click)="closeSidebarOnMobile()"
                  [class.active]="isActiveRoute('/admin-usuarios/editar')"
                >
                  <i class="fi fi-rs-admin-alt"></i>
                  <span>Editar usuario</span>
                </a>
              </li>
            </ul>
          </li>

          <li [class.li-activa]="isActiveRoute('/perfil')">
            <a
              routerLink="/perfil"
              (click)="closeSidebarOnMobile()"
              [title]="sidebarCollapsed ? 'Cambiar contraseña' : ''"
            >
              <i class="fi fi-rr-user-key"></i>
              <span *ngIf="!sidebarCollapsed">Cambiar contraseña</span>
            </a>
          </li>

          <li>
            <a
              (click)="cerrarSesion()"
              [title]="sidebarCollapsed ? 'Cerrar sesión' : ''"
            >
              <i class="fi fi-rs-sign-out-alt"></i>
              <span *ngIf="!sidebarCollapsed">Cerrar sesión</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <div
    class="overlay-backdrop"
    [class.active]="sidebarActive && isMobile"
    (click)="closeSidebarOnMobile()"
  ></div>
</div>
